<div class="container view">
    <div class="mx-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="green-text fw-bold mb-0">
                <i class="ph ph-arrow-left me-2"  onclick="goBackView()" style="cursor:pointer"></i>
                Start Chat
            </h5>

        </div>
        <br>

    </div>
    <form class="py-3" id="_form">

    <div class="row g-3">


        <div class="col-12">
            <div class="bg-light p-3 rounded-3 bg-light">
                <h6 class="dark-text mb-1">New chat with {{profile}} [ {{account_no}} ]</h6>
            </div>
        </div>
        <div class="mb-3 border rounded-3  bg-light p-3">
            <label class="text-muted fw-lighter fs-6 mb-1">message:</label>
            <textarea type="text" name="message" class="form-control form-control-lg" >hi</textarea>

        </div>


    </div>
        <p id="form_result" class="small text-danger ps-2"></p>
        <hr>
        <div class="d-flex justify-content-center align-items-center mt-4">
            <button type="button" id="btn_submit_item" class="btn btn-success btn-lg rounded-2 px-4 shadow-sm">
                Start Chat
            </button>

        </div>
    </form>

    
</div>
<script type="text/javascript">

    $('#btn_submit_item').on('click', function () {
    overlay('start');
     current = JSON.parse(localStorage.getItem("current_account"));

    console.log('submitting...')
    var msg = $('#form_result'), _btn = $(this), _form = $('#_form').serialize()+ "&institution_user=" + current.iD+  "&institution_user2=" + {{iD}}+ "&api=true&messageType=1&user=" + user.iD;

    msg.html(""); _btn.attr("disabled", "true"); _btn.html("Processing...");
    var uri =  site + "/create-directchat";
    console.log("_form: " + _form);
    $.ajax({  url:uri, type: 'POST', dataType: 'application/json', data: _form,
    complete: function (data) {
   overlay('stop');
    console.log("CRHp: " + data.responseText);


    _btn.removeAttr("disabled"); console.log("rs: " + data.responseText.toString());
    var result = JSON.parse(data.responseText.toString());

    _btn.html("Update again");

    //showAlert(rString) //get_pagination();
    if (result.status == 1) {
    //loadData()

   // msg.html(create_message("success", result.message));
     navigateTo('direct-chat');
//navigateTo('view-chat', {iD:result.chatiD, othername:result.other})
    //	document.location.reload();
    } else { _btn.html("Try again"); msg.html(create_message("danger", result.message)); }
    },
    success: function (response) {
    console.log('res: ' + response)
    const data = JSON.parse(response);

    },
    error: function (error, status, xhr) {
    console.log("Error loading data " + JSON.stringify(error)  + " xhr: " + xhr);
    }
    });

    })

</script>